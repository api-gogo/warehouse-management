<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="~{layouts/default-layout}">
<head>
  <title>재고 상세 정보</title>
  <!-- 페이지별 CSS -->
  <th:block layout:fragment="css">
    <link rel="stylesheet" href="/common.css">
  </th:block>
</head>
<body>
  <!-- 페이지 콘텐츠 -->
  <th:block layout:fragment="content" th:with="activeMenu='inventory'">
    <div class="common-container">
      <div class="common-header">
        <h1 class="common-title">재고 상세 정보</h1>
        <div class="common-actions">
          <a th:href="@{/inventories}" class="btn btn-primary">
            <i class="fas fa-arrow-left"></i> 목록으로
          </a>
        </div>
      </div>
      
      <div class="common-content">
        <!-- 오류 메시지가 있는 경우 표시 -->
        <div class="alert alert-danger" th:if="${errorMessage != null}">
          <i class="fas fa-exclamation-circle"></i>
          <span th:text="${errorMessage}">오류 메시지</span>
        </div>
        
        <!-- 상품 정보 섹션 -->
        <div class="detail-section" th:if="${inventory != null and !#lists.isEmpty(inventory)}">
          <h2 class="section-title" th:text="${inventory[0].productName}">상품명</h2>
          <p class="section-description">
            상품 ID: <span th:text="${inventory[0].productId}">상품 ID</span> / 
            총 재고 항목: <span th:text="${inventory.size()}">항목 수</span>개
          </p>
          
          <!-- 재고 목록 테이블 -->
          <div class="table-responsive">
            <table class="data-table">
              <thead>
                <tr>
                  <th>재고 ID</th>
                  <th>로트번호</th>
                  <th>위치코드</th>
                  <th>가용재고</th>
                  <th>할당재고</th>
                  <th>유통기한</th>
                  <th>상태</th>
                  <th>수정 / 삭제</th>
                </tr>
              </thead>
              <tbody>
                <tr th:each="item : ${inventory}">
                  <td th:text="${item.inventoryId}">ID</td>
                  <td th:text="${item.lotNumber}">로트번호</td>
                  <td th:text="${item.locationCode}">위치코드</td>
                  <td th:text="${item.availableStock}">가용재고</td>
                  <td th:text="${item.allocatedStock}">할당재고</td>
                  <td th:text="${#temporals.format(item.inventoryExpiryDate, 'yyyy-MM-dd')}">유통기한</td>
                  <td>
                    <span class="status-badge" 
                          th:classappend="${item.availableStock > 50 ? 'status-active' : 'status-low'}"
                          th:text="${item.availableStock > 50 ? '정상' : '부족'}">
                      상태
                    </span>
                  </td>
                  <td class="actions">
                    <a th:href="@{/inventories/edit/{id}(id=${item.inventoryId})}" class="action-button" title="수정">
                      <i class="fas fa-edit"></i>
                    </a>
                    <a th:href="@{/inventories/delete/{id}(id=${item.inventoryId})}" class="action-button" 
                       onclick="return confirm('정말로 이 재고를 삭제하시겠습니까?');" title="삭제">
                      <i class="fas fa-trash"></i>
                    </a>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        
        <!-- 데이터가 없을 경우 -->
        <div class="empty-state" th:if="${inventory == null or #lists.isEmpty(inventory)}">
          <div class="alert alert-info">
            <i class="fas fa-info-circle"></i>
            <span>해당 상품의 재고 정보가 존재하지 않습니다.</span>
          </div>
          <div class="form-actions" style="justify-content: center;">
            <a th:href="@{/inventories/add}" class="btn btn-primary">
              <i class="fas fa-plus"></i> 재고 추가
            </a>
          </div>
        </div>
      </div>
    </div>
  </th:block>
  
  <!-- 페이지별 스크립트 -->
  <th:block layout:fragment="scripts">
    <script th:inline="javascript">
      /*<![CDATA[*/
      document.addEventListener('DOMContentLoaded', function() {
        // 스크립트 실행 여부 확인을 위한 로그
        console.log("재고 상세 페이지 스크립트 로딩 완료");
      });
      /*]]>*/
    </script>
  </th:block>
</body>
</html>